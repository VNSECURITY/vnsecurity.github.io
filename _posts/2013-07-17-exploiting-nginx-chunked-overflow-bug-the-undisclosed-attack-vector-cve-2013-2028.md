---
title: Exploiting nginx chunked overflow bug, the undisclosed attack vector (CVE-2013-2028)
author: longld
layout: post
thumbnail: /assets/2013/05/nginx.png
category: research
tags:
  - 1.4.0
  - cve-2013-2028
  - exploit
  - nginx
---
In [previous post][1], we analyzed and exploited stack based buffer overflow vulnerability in chunked encoding parsing of nginx-1.3.9 &#8211; 1.4.0. We mentioned that there was another attack vector which was more practical, more reliable. I talked about this attack vector at [SECUINSIDE][2] 2013 in July (btw, a great conference and CTF). Details can be found in [slides][3].

In summary:

*   Same [bug][1] with different code paths that serve dynamic contents via fastcgi, proxy backend, etc. These configurations are more practical in real world environments.
*   Heap based overflow instead of stack based overflow as described in the original advisory. Nothing to worry about stack cookie (so no bruteforcing).
*   The trick to make heap overflow exploit more reliable is via connection spraying.
*   Some small tips and tricks for ROP and shellcode.

Enjoy hacking!

 [1]: http://www.vnsecurity.net/2013/05/analysis-of-nginx-cve-2013-2028/
 [2]: http://www.secuinside.com
 [3]: http://ropshell.com/slides/Nginx_chunked_overflow_the_undisclosed_attack_vector.pdf